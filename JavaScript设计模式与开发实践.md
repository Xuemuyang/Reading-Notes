# JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ

## å‰è¨€

"æ¨¡å¼"æœ€æ—©è¯ç”Ÿäºå»ºç­‘å­¦ã€‚å“ˆä½›å¤§å­¦å»ºç­‘å­¦åšå£«Christopher Alexanderå’Œä»–çš„ç ”ç©¶å›¢é˜ŸèŠ±äº†çº¦20å¹´çš„æ—¶é—´ï¼Œç ”ç©¶äº†ä¸ºè§£å†³åŒä¸€ä¸ªé—®é¢˜è€Œè®¾è®¡å‡ºçš„ä¸åŒå»ºç­‘ç»“æ„ï¼Œä»ä¸­å‘ç°äº†é‚£äº›é«˜è´¨é‡è®¾è®¡ä¸­çš„ç›¸ä¼¼æ€§ï¼Œå¹¶ä¸”ç”¨"æ¨¡å¼"æ¥æŒ‡ä»£è¿™ç§ç›¸ä¼¼æ€§ã€‚

é€šä¿—ä¸€ç‚¹æ¥è¯´ï¼Œè®¾è®¡æ¨¡å¼æ˜¯åœ¨æŸç§åœºåˆä¸‹å¯¹æŸä¸ªé—®é¢˜çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚

"å¥½çš„è®¾è®¡"å¹¶ä¸æ˜¯æŸäººå‘æ˜çš„ï¼Œè€Œæ˜¯ä¸€ç›´å­˜åœ¨çš„ï¼Œå¤§å®¶ä¼šå‡­ç»éªŒä¸€ç›´ä½¿ç”¨ï¼Œ"æ¨¡å¼"ä¸è¿‡æ˜¯ç»™"å¥½çš„è®¾è®¡"èµ·ä¸ªåå­—ã€‚

è®¾è®¡æ¨¡å¼çš„ä½œç”¨æ˜¯è®©äººä»¬å†™å‡ºå¯å¤ç”¨å’Œå¯ç»´æŠ¤æ€§é«˜çš„ç¨‹åºã€‚

æ‰€æœ‰è®¾è®¡æ¨¡å¼çš„å®ç°éƒ½éµå¾ª"æ‰¾å‡ºç¨‹åºä¸­å˜åŒ–çš„åœ°æ–¹ï¼Œå°†å…¶å°è£…èµ·æ¥"ã€‚

## ç¬¬ä¸€éƒ¨åˆ† åŸºç¡€çŸ¥è¯†

### ç¬¬1ç«  é¢å‘å¯¹è±¡çš„JavaScript

#### åŠ¨æ€ç±»å‹è¯­è¨€å’Œé¸­å­ç±»å‹

ç¼–ç¨‹è¯­è¨€æŒ‰ç…§æ•°æ®ç±»å‹å¤§ä½“å¯ä»¥åˆ†ä¸ºä¸¤ç±»

+ é™æ€ç±»å‹è¯­è¨€(ç¼–è¯‘æ—¶ç¡®å®šç±»å‹)
+ åŠ¨æ€ç±»å‹è¯­è¨€(è¿è¡Œæ—¶ç¡®å®šç±»å‹)

> é¸­å­ç±»å‹(duck typing)ï¼Œå¦‚æœå®ƒèµ°èµ·è·¯æ¥åƒé¸­å­ï¼Œå«èµ·æ¥ä¹Ÿæ˜¯é¸­å­ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯é¸­å­ã€‚

åœ¨åŠ¨æ€ç±»å‹è¯­è¨€çš„é¢ç›¸å¯¹è±¡è®¾è®¡ä¸­ï¼Œé¸­å­ç±»å‹çš„æ¦‚å¿µè‡³å…³é‡è¦ã€‚æˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°"é¢ç›¸æ¥å£ç¼–ç¨‹"ã€‚ä¾‹å¦‚ä¸€ä¸ªå¯¹è±¡è‹¥æœ‰`push`å’Œ`pop`æ–¹æ³•ï¼Œå®ƒå°±å¯ä»¥è¢«å½“åšæ ˆæ¥ä½¿ç”¨ã€‚

#### å¤šæ€

JavaScriptå¯¹è±¡çš„å¤šæ€æ€§æ˜¯ä¸ç”Ÿä¿±æ¥çš„ï¼ŒæŸä¸€ç§åŠ¨ç‰©èƒ½å¦å‘å‡ºå«å£°ï¼Œåªå–å†³äºå®ƒæœ‰æ²¡æœ‰`makeSound`æ–¹æ³•ï¼Œè€Œä¸å–å†³äºå®ƒæ˜¯å¦æ˜¯æŸç§ç±»å‹çš„å¯¹è±¡ã€‚

> å¤šæ€æœ€æ ¹æœ¬çš„ä½œç”¨å°±æ˜¯é€šè¿‡å§è¿‡ç¨‹åŒ–çš„æ¡ä»¶åˆ†æ”¯è¯­å¥è½¬åŒ–ä¸ºå¯¹è±¡çš„å¤šæ€æ€§ï¼Œä»è€Œæ¶ˆé™¤è¿™äº›æ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚

ä¸€ä¸ªä¾‹å­å¾ˆå¥½çš„è¯ é‡Š

ç”µå½±æ‹æ‘„ç°åœºï¼Œå¯¼æ¼”å–Šå‡º"action"ï¼Œä¸»è§’å¼€å§‹èƒŒå°è¯ï¼Œç¯å…‰å¸ˆå‚…æ‰“ç¯ï¼Œç¾¤ä¼—æ¼”å‘˜å€’åœ°ã€‚å¾—åˆ°åŒä¸€ä¸ªæ¶ˆæ¯æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½çŸ¥é“è‡ªå·±åº”è¯¥åšä»€ä¹ˆã€‚

æ¯ä¸ªå¯¹è±¡è¯¥åšä»€ä¹ˆï¼Œäº‹å…ˆå·²ç»æ˜¯è¯¥å¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¢«å®‰è£…åœ¨å¯¹è±¡çš„å†…éƒ¨ã€‚

ç”¨ä»£ç ä¸¾ä¸ªğŸŒ°

ä¸€ä¸ªåœ°å›¾åº”ç”¨ï¼Œæˆ‘ä»¬é€‰æ‹©googleçš„API

```js
const googleMap = {
  show() {
    console.log('å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾')
  }
}

const renderMap = () => {
  googleMap.show()
}

renderMap()
```

åæ¥ç”±äºæŸäº›åŸå› ï¼Œæˆ‘ä»¬éœ€è¦æŠŠgoogleæ¢æˆç™¾åº¦ï¼Œäºæ˜¯ä»£ç å˜æˆäº†è¿™æ ·:

```js
const googleMap = {
  show() {
    console.log('å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾')
  }
}

const baiduMap = {
  show() {
    console.log('å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾')
  }
}

const renderMap = type => {
  if (type === 'google') {
    googleMap.show()
  } else if (type === 'baidu') {
    baiduMap.show()
  }
}

renderMap('google')
renderMap('baidu')
```

ä¸€æ—¦éœ€è¦å°†å…¶æ¢æˆé«˜å¾·åœ°å›¾ï¼Œå¿…é¡»è¦æ”¹åŠ¨renderMapå‡½æ•°ï¼Œç»§ç»­å †ç Œæ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚

å°†ç¨‹åºä¸­ç›¸åŒçš„éƒ¨åˆ†æŠ½è±¡å‡ºæ¥:

```js
const renderMap = map => {
  if (map.show instanceof Function) {
    map.show()
  }
}

renderMap(googleMap)
renderMap(baiduMap)
```

#### å°è£…

#### åŸå‹æ¨¡å¼å’ŒåŸºäºåŸå‹ç»§æ‰¿çš„JavaScriptå¯¹è±¡ç³»ç»Ÿ

åŸå‹æ¨¡å¼çš„å®ç°å…³é”®ï¼Œæ˜¯è¯­è¨€æœ¬èº«æ˜¯å¦æä¾›äº†`clone`çš„æ–¹æ³•ã€‚

```js
Object.create = Object.create || function( obj ){
  const F = function(){}
  F.prototype = obj
  return new F()
}
```

åŸºäºåŸå‹é“¾çš„å§”æ‰˜æœºåˆ¶å°±æ˜¯åŸå‹ç»§æ‰¿çš„æœ¬è´¨ã€‚

åŸå‹ç¼–ç¨‹èŒƒå‹è‡³å°‘åŒ…æ‹¬ä»¥ä¸‹åŸºæœ¬è§„åˆ™:

+ æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å¯¹è±¡
+ è¦å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯é€šè¿‡å®ä¾‹åŒ–ç±»ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹å¹¶å…‹éš†å®ƒ
+ å¯¹è±¡ä¼šè®°ä½å®ƒçš„åŸå‹
+ å¦‚æœå¯¹è±¡æ— æ³•å“åº”æŸä¸ªè¯·æ±‚ï¼Œå®ƒä¼šæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å®ƒè‡ªå·±çš„åŸå‹

##### JavaScriptä¸­çš„åŸå‹ç»§æ‰¿

è¦å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æ˜¯é€šè¿‡å®ä¾‹åŒ–ç±»ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä½œä¸ºåŸå‹å¹¶å…‹éš†å®ƒã€‚

JavaScriptä¸ªå¯¹è±¡æä¾›äº†ä¸€ä¸ªåä¸º`__proto__`çš„éšè—å±æ€§ï¼ŒæŸä¸ªå¯¹è±¡çš„`__proto__`å±æ€§é»˜è®¤ä¼šæŒ‡å‘å®ƒçš„æ„é€ å™¨çš„åŸå‹å¯¹è±¡ï¼Œå³{Construcrot}.prototypeã€‚åœ¨ä¸€äº›æµè§ˆå™¨ä¸Š`__proto__`å±æ€§è¢«å…¬å¼€å‡ºæ¥ã€‚

```js
const a = new Object()
console.log(a.__proto__ === Object.prototype)
```

### ç¬¬2ç«  thisã€callå’Œapply

#### this

`this`çš„æŒ‡å‘å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å››ç§:

+ ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨
+ ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨
+ æ„é€ å™¨è°ƒç”¨
+ Function.prototype.callæˆ–Function.prototype.applyè°ƒç”¨

å½“å‡½æ•°ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œ`this`æŒ‡å‘è¯¥å¯¹è±¡

å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡çš„å±æ€§è¢«è°ƒç”¨æ—¶ï¼Œ`this`æ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡

å½“ç”¨`new`è¿ç®—ç¬¦è°ƒç”¨å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°æ€»ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ„é€ å™¨é‡Œçš„`this`å°±æŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡:

```js
let MyClass = function() {
  this.name = 'hehe'
}

let obj = new MyClass()
alert(obj.name) // output: hehe
```

å¦‚æœæ„é€ å™¨æ˜¾å¼è¿”å›äº†ä¸€ä¸ªobjectç±»å‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ­¤æ¬¡è¿ç®—ç»“æœæœ€ç»ˆä¼šè¿”å›è¿™ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¹‹å‰æœŸå¾…çš„`this`ã€‚

```js
let MyClass = function() {
  this.name = 'hehe'
  return {
    name: 'haha'
  }
}
var obj = new MyClass()
alert ( obj.name ) // è¾“å‡º:haha
```

#### callå’Œapply

èƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨`call`å’Œ`apply`æ˜¯çœŸæ­£æˆä¸ºJavaScriptç¨‹åºå‘˜çš„é‡è¦ä¸€æ­¥ã€‚

##### callå’Œapplyçš„ç”¨é€”

1.æ”¹å˜`this`æŒ‡å‘

```js
document.getElementById = (function(func){
  return function() {
    return func.apply(document, arguments)
  }
})(document.getElementById)
var getId = document.getElementById
var div = getId('div')
alert(div.id)
```

2.Function.prototype.bind
3.å€Ÿç”¨å…¶ä»–å¯¹è±¡çš„æ–¹æ³•

### ç¬¬3ç«  é—­åŒ…å’Œé«˜é˜¶å‡½æ•°

#### é—­åŒ…

ä¸€ä¸ªğŸŒ°

```js
const Type = {};

for (let i = 0, type; type = ['String', 'Array', 'Number'][i++];) {
  Type['is' + type] = obj => {
    return Object.prototype.toString.call(obj) === `[object ${type}]`
  }
};

Type.isArray([])
Type.isString('str')
```

##### å°è£…å˜é‡

é—­åŒ…å¯ä»¥å°†ä¸€äº›ä¸éœ€è¦æš´éœ²åœ¨å…¨å±€çš„å˜é‡å°è£…æˆ"ç§æœ‰å˜é‡"ã€‚

```js
const mult = (...args) => {
  let val  = 1
  for (let i = 0; i < args.length; i++) {
    val *= args[i]
  }
  return val
}
```

åŠ å…¥ç¼“å­˜æ¥æé«˜è¿™ä¸ªå‡½æ•°çš„æ€§èƒ½

```js
const cache = {}

const mult = (...args) => {
  let key = args.join(',')
  if (cache[key]) {
    return cache[key]
  }
  let val = 1
  for (let i = 0; i < args.length; i++) {
    val *= args[i]
  }
  return cache[key] = val
}
```

`cache`è¿™ä¸ªå˜é‡ä»…ä»…åœ¨`mult`å‡½æ•°ä¸­è¢«ä½¿ç”¨ï¼Œå°†å…¶å°é—­åœ¨`mult`å‡½æ•°å†…éƒ¨ã€‚

```js
const mult = () => {
  const cache = {}
  return function (...args) {
    let key = args.join(',')
    if (key in cache) {
      return cache[key]
    }
    let val = 1
    for (let i = 0; i < args.length; i++) {
      val *= args[i]
    }
    return cache[key] = val
  }
}
```

æç‚¼å‡½æ•°æ˜¯ä»£ç é‡æ„ä¸­çš„å¸¸è§æŠ€å·§ï¼Œå¦‚æœåœ¨ä¸€ä¸ªå¤§å‡½æ•°ä¸­æœ‰ä¸€äº›ä»£ç å—èƒ½å¤Ÿç‹¬ç«‹å‡ºæ¥ï¼Œå¸¸å¸¸æŠŠè¿™äº›ä»£ç å—å°è£…åœ¨ç‹¬ç«‹çš„å°å‡½æ•°é‡Œé¢ã€‚ç‹¬ç«‹å‡ºæ¥çš„å°å‡½æ•°æœ‰åŠ©äºä»£ç å¤ç”¨ï¼Œå¦‚æœè¿™äº›å°å‡½æ•°æœ‰ä¸€ä¸ªè‰¯å¥½çš„å‘½åï¼Œå®ƒä»¬æœ¬èº«ä¹Ÿèµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨ã€‚

```js
const mult = () => {
  const cache = {}
  const calculate = (...args) => {
    let val = 1
    for (let i = 0; i < args.length; i++) {
      val *= args[i]
    }
    return val
  }
  return function (...args) {
    let key = args.join(',')
    if (key in cache) {
      return cache[key]
    }
    return cache[key] = calculate.apply(null, args)
  }
}
```

#### é«˜é˜¶å‡½æ•°

é«˜é˜¶å‡½æ•°å¼æŒ‡è‡³å°‘æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€çš„å‡½æ•°

+ å‡½æ•°å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’
+ å‡½æ•°å¯ä»¥ä½œä¸ºè¿”å›å€¼è¾“å‡º

å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œä»£è¡¨å¯ä»¥æŠ½ç¦»ä¸€éƒ¨åˆ†å®¹æ˜“å˜åŒ–çš„ä¸šåŠ¡é€»è¾‘ï¼Œå°†è¿™éƒ¨åˆ†ä¸šåŠ¡é€»è¾‘æ”¾åœ¨å‡½æ•°å‚æ•°ä¸­ï¼Œå›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªé‡è¦çš„åº”ç”¨åœºæ™¯ã€‚

##### å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’

1.å›è°ƒå‡½æ•°

ç›´æ¥çœ‹ğŸŒ°

åœ¨é¡µé¢ä¸­åˆ›å»º100ä¸ªdivèŠ‚ç‚¹ï¼Œç„¶åå°†è¿™äº›èŠ‚ç‚¹è®¾ç½®ä¸ºéšè—

```js
const appendDiv = function() {
  for(let i = 0; i < 100; i++) {
    const div = document.createElement('div')
    div.innerHTML = i
    document.body.appendChild(div)
    div.style.display = 'none'
  }
}

appendDiv()
```

å°†`div.style.display = 'none'`æ”¾åœ¨å‡½æ•°ä¸­æ˜¯ä¸åˆç†çš„ï¼Œè¿™ä¸ªå‡½æ•°è¿‡äº"ä¸ªæ€§åŒ–"ï¼Œéš¾ä»¥å¤ç”¨ï¼Œè¿™æ ·æ”¹é€ :

```js
const appendDiv = function(callback) {
  for (let i = 0; i < 100; i++) {
    const div = document.createElement('div')
    div.innerHTML = i
    document.body.appendChild(div)
    if (typeof callback === 'function') {
      callback(div)
    }
  }
}

appendDiv(node => {
  node.style.display = 'none'
})
```

2.Array.prototype.sort

æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°é‡Œå°è£…äº†æ•°ç»„å…ƒç´ çš„æ’åºè§„åˆ™

##### å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡º

è¿™æ˜¯ä¸€ä¸ªå•ä¾‹æ¨¡å¼çš„ğŸŒ°

```js
const getSingle = function(fn) {
  let ret
  return function(...args) {
    return ret || (ret = fn.apply(this, args))
  }
}
```

##### é«˜é˜¶å‡½æ•°å®ç°AOP

AOP(é¢å‘åˆ‡é¢ç¼–ç¨‹)çš„ä¸»è¦ä½œç”¨æ˜¯æŠŠä¸€äº›è·Ÿæ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ— å…³çš„åŠŸèƒ½æŠ½ç¦»å‡ºæ¥ï¼Œé€šå¸¸åŒ…æ‹¬æ—¥å¿—åŒçº§ã€å®‰å…¨æ§åˆ¶ã€å¼‚å¸¸å¤„ç†ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ä¿æŒä¸šåŠ¡é€»è¾‘æ¨¡å—çš„çº¯å‡€å’Œé«˜å†…èšæ€§ã€‚

åœ¨JavaScriptä¸­å®ç°AOPï¼Œé€šå¸¸æ˜¯æŠŠä¸€ä¸ªå‡½æ•°"åŠ¨æ€ç»‡å…¥"åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°ä¹‹ä¸­ã€‚

```js
Function.prototype.before = function(beforefn) {
  const __self = this // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨
  return function(...args) {
    beforefn.apply(this, args)
    return __self.apply(this, args)
  }
}

Function.prototype.after = function(afterfn) {
  const __self = this
  return function(...args) {
    let ret = __self.apply(this, args)
    afterfn.apply(this, args)
    return ret
  }
}

const func = function() {
  console.log(2)
}

const funcAOP = func.before(function() {
  console.log(1)
}).after(function() {
  console.log(3)
})

funcAOP()
```

è¿™æ˜¯è£…é¥°è€…æ¨¡å¼å®ç°ã€‚

##### é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨

1.currying

`currying`åˆç§°éƒ¨åˆ†æ±‚å€¼ã€‚ä¸€ä¸ª`currying`çš„å‡½æ•°é¦–å…ˆä¼šæ¥æ”¶ä¸€äº›å‚æ•°ï¼Œæ¥æ”¶è¿™äº›å‚æ•°ä¹‹åï¼Œè¯¥å‡½æ•°ä¸ä¼šç«‹å³æ±‚å€¼ï¼Œè€Œæ˜¯ç»§ç»­è¿”å›å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œåˆšæ‰ä¼ å…¥çš„å‚æ•°åœ¨å‡½æ•°å½¢æˆçš„é—­åŒ…ä¸­è¢«ä¿å­˜èµ·æ¥ã€‚å¾…åˆ°å‡½æ•°çœŸæ­£éœ€è¦æ±‚å€¼çš„æ—¶å€™ï¼Œä¹‹å‰ä¼ å…¥çš„æ‰€æœ‰å‚æ•°éƒ½ä¼šè¢«ä¸€æ¬¡æ€§ç”¨äºæ±‚å€¼ã€‚

2.uncurrying

3.å‡½æ•°èŠ‚æµ

ä¸‹åˆ—åœºæ™¯

+ window.onsizeäº‹ä»¶
+ mousemoveäº‹ä»¶
+ ä¸Šä¼ è¿›åº¦

4.åˆ†æ—¶å‡½æ•°

åœºæ™¯:åœ¨WebQQå¥½å‹åˆ—è¡¨ä¸­ï¼Œå¯èƒ½ä¸€æ¬¡æ€§å¾€é¡µé¢ä¸­æ·»åŠ åƒæ•°é‡çº§çš„èŠ‚ç‚¹ã€‚

`timeChunk`å‡½æ•°è®©åˆ›å»ºèŠ‚ç‚¹çš„å·¥ä½œåˆ†æ‰¹è¿›è¡Œï¼Œæ¯”å¦‚ä¸€ç§’åˆ›å»º1000ä¸ªæ”¹ä¸ºæ¯éš”200æ¯«ç§’åˆ›å»º200ä¸ªã€‚

```js
const timeChunk = function(array, fn, count) {
  const start = function() {
    for(let i = 0; i < Math.min(count || 1, array.length); i++) {
      let obj = array.shift()
      fn(obj)
    }
  }

  return function() {
    let t = setInterval(() => {
      if (array.length === 0) {
        return clearInterval(t)
      }
      start()
    }, 200)
  }
}
```

5.æƒ°æ€§åŠ è½½å‡½æ•°

é¿å…æ¯æ¬¡éƒ½è®©ç¨‹åºæ‰§è¡Œåˆ¤æ–­è¿‡ç¨‹

```js
const addEvent = (() => {
  if (window.addEventListener) {
    return function(elem, type, handler) {
      elem.addEventListener(type, handler, flase)
    }
  }
  if (window.attachEvent) {
    return function(elem, type, handler) {
      elem.attachEvent(`on${type}`, handler)
    }
  }
})()
```

å¯¹äºè¿™ä¸ªåœºæ™¯è¿˜æœ‰è¿™ç§è§£å†³ï¼Œå³åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­æ”¹å†™å‡½æ•°ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å‡å°‘åˆå§‹åŒ–å¼€é”€

```js
let addEvent = function(elem, type, handler) {
  if (window.addEventListener) {
    addEvent = function(elem, type, handler) {
      elem.addEventListener(type, handler, flase)
    }
  } else if (window.attachEvent) {
    addEvent = function(elem, type, handler) {
      elem.attachEvent(`on${type}`, handler)
    }
  }

  addEvent(elem, type, handler)
}
```

## ç¬¬äºŒéƒ¨åˆ† è®¾è®¡æ¨¡å¼

### ç¬¬4ç«  å•ä¾‹æ¨¡å¼