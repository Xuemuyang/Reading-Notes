# æœ‰è¶£çš„ğŸŒ°

1.è¾“å‡ºæ˜¯ä»€ä¹ˆ

```javascript
function Foo() {
  var i = 0;
  return function() {
    console.log(i++);
  };
}

var f1 = Foo(),
  f2 = Foo();

f1();
f1();
f2();
//0 1 0
```

æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å¯¹è±¡ï¼Œå‡½æ•°å†…éƒ¨çš„å˜é‡ä½œä¸ºå®ƒçš„å±æ€§å­˜åœ¨ã€‚ä¸¤æ¬¡è°ƒç”¨`Foo()`æ—¶ï¼Œå†…éƒ¨çš„`i`æ˜¯ä¸åŒçš„å˜é‡ã€‚

2.è¾“å‡ºæ˜¯ä»€ä¹ˆ

```javascript
var myObject = {
  foo: "bar",
  func: function() {
    var self = this;
    console.log(this.foo);
    console.log(self.foo);

    (function() {
      console.log(this.foo);
      console.log(self.foo);
    })();
  }
};
myObject.func(); // bar bar undefined bar
```

`this`æ˜¯åŠ¨æ€ä½œç”¨åŸŸï¼Œè°ƒç”¨æ—¶ç»‘å®šï¼Œä½œç”¨åŸŸæ˜¯è¯æ³•ä½œç”¨åŸŸã€‚
è¿™ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°çš„è°ƒç”¨æ–¹å¼ä¸ºè‡ªæ‰§è¡Œï¼Œ`this`æŒ‡å‘å…¨å±€ï¼Œ`self.foo`ä¼šåœ¨è¯æ³•ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ã€‚

3.è¾“å‡ºæ˜¯ä»€ä¹ˆ

```javascript
function test() {
  var n = 4399;

  function add() {
    n++;
    console.log(n);
  }

  return {
    n: n,
    add: add
  };
}
var result = test();
var result2 = test();

result.add();
result.add();
console.log(result.n);
result2.add();
//4400 4401 4399 4400
```

`return`ä¸­çš„`add`å‡½æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œæ‰€ä»¥`console.log(result.n)`ä¸­çš„`add`æ–¹æ³•ä¸`result`ä¸­çš„`n`æ²¡æœ‰ç›´æ¥å…³ç³»,ç­‰äºæ˜¯`test`ä¸­`add`å‡½æ•°çš„åˆ«åã€‚

4.å°ç®—æ³•é¢˜

ç»™å®šä¸€ä¸ªé•¿åº¦å°äº`50`ä¸”åŒ…å«å­—æ¯å’Œæ•°å­—çš„ä»»æ„å­—ç¬¦ä¸²ï¼Œè¦æ±‚æŒ‰é¡ºåºå–å‡ºå½“ä¸­çš„æ•°å­—å’Œè‹±æ–‡å­—æ¯ï¼Œæ•°å­—éœ€è¦å»é‡ï¼Œé‡æ–°æ’åˆ—åçš„å­—ç¬¦ä¸²æ•°å­—åœ¨å‰ï¼Œå­—æ¯åœ¨åã€‚

æ ·ä¾‹è¾“å…¥

```js
"æºç¨‹C2t0r1i8p2020æ ¡æ‹›";
```

æ ·ä¾‹è¾“å‡º

```js
"2018Ctrip";
```

```js
[...new Set([...str.match(/\d/g), ...str.match(/[a-zA-Z]/g)])].join("");
```

5.å°ç®—æ³•é¢˜

ç»™å®šä¸¤ä¸ªé•¿åº¦ç›¸åŒçš„æ•´æ•°æ•°ç»„ï¼Œå°†å…¶ä¸­çš„æ•°å­—åˆ†åˆ«ä¸€ä¸€é…å¯¹ï¼Œå¯¹æ¯ä¸€å¯¹æ•°å­—è®¡ç®—ä¹˜ç§¯ï¼Œç„¶åæ±‚å’Œï¼Œè®¡ç®—å‡ºæ€»å’Œæœ€å°çš„é…å¯¹æ–¹å¼ï¼Œå¹¶æ‰“å°å‡ºæ€»å’Œ

æ ·ä¾‹è¾“å…¥

```js
[1, 2, 3], [1, 2, 3];
```

æ ·ä¾‹è¾“å‡º

```js
10;
```

```js
module.exports = (arr1, arr2) => {
  arr1 = arr1.sort((a, b) => a - b);
  arr2 = arr2.sort((a, b) => b - a);
  return arr1.reduce((sum, value, i) => sum + value * arr2[i], 0);
};
```

6.çº¢ç»¿ç¯æ¯ä¸ªæŒç»­ä¸¤ç§’

```html
<ul id="traffic" class="wait">
  <li><span></span></li>
  <li><span></span></li>
  <li><span></span></li>
</ul>
```

```css
#traffic > li{
  display: block;
}

#traffic span{
  display: inline-block;
  width: 50px;
  height: 50px;
  background-color: gray;
  margin: 5px;
  border-radius: 50%;
}

#traffic.stop li:nth-child(1) span{
  background-color: #a00;
}

#traffic.wait li:nth-child(2) span{
  background-color: #aa0;
}

#traffic.pass li:nth-child(3) span{
  background-color: #0a0;
}
```

ç‰ˆæœ¬1ï¼šå›è°ƒåœ°ç‹±

```js
const traffic = document.getElementById('traffic');

(function loop(){
  traffic.className = 'wait';

  function setState(state, delay, callback) {
    traffic.className = state
    setTimeout(callback, delay)
  }
  setState('stop', 2000, () => {
    setState('pass', 2000, () => {
      setState('wait', 2000, loop)
    })
  })
})();
```

ç‰ˆæœ¬2ï¼š

```js
const traffic = document.getElementById('traffic');

function loop(traffic, stateList){
  var currentStateIndex = 0;

  setInterval(function(){
    var state = stateList[currentStateIndex];
    traffic.className = state;
    currentStateIndex = (currentStateIndex + 1) % stateList.length;
  }, 2000);
}

loop(traffic, ['wait', 'stop', 'pass']);
```

ç‰ˆæœ¬3ï¼šPromise

```js
const traffic = document.getElementById('traffic');

function wait(time){
  return new Promise(resolve => setTimeout(resolve, time));
}

function setState(state, last = 2000){
  traffic.className = state;
  return wait(last)
}

(function loop(){
  Promise.resolve()
    .then(setState.bind(null, 'wait'))
    .then(setState.bind(null, 'stop'))
    .then(setState.bind(null, 'pass'))
    .then(loop);
}())
```

ç‰ˆæœ¬4: Async/Await

```js
const traffic = document.getElementById('traffic');

function wait(time){
  return new Promise(resolve => setTimeout(resolve, time));
}

function setState(state, last = 2000){
  traffic.className = state;
  return wait(last)
}

(async function () {
  //noprotected
  while(1) {
    await setState('wait')
    await setState('stop')
    await setState('pass')
  }
}())
```
