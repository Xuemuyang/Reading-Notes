# å‘½ä»¤è¡ŒåŠŸèƒ½

## é—®é¢˜

- [x] å¦‚ä½•å¯¹å¤–æš´éœ²å‘½ä»¤è¡Œæ¥å£(é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨)
- [x] å‘½ä»¤è¡Œå·¥å…·å¦‚ä½•è¯»å–å‚æ•°
  - [x] å‘½ä»¤è¡Œçš„è¡¨å•äº¤äº’
  - [x] é•¿å‘½ä»¤ï¼ŒçŸ­å‘½ä»¤(å‘½ä»¤åˆ«å) alias
  - [x] è·å–å‘½ä»¤åé¢çš„å‚æ•°
  - [x] å¼¹å‡ºä½¿ç”¨å¸®åŠ©
  - [x] äº‹ä»¶å¤„ç†ç¨‹åº
- [ ] æ›´æ–°
- [ ] é”™è¯¯ä¸ŠæŠ¥
- [x] ç»ˆç«¯æ ·å¼

## æš´éœ²å‘½ä»¤è¡Œæ¥å£

é€šè¿‡ `package.json` ä¸­çš„ `bin` å­—æ®µæ¥æŒ‡å®š **å‘½ä»¤çš„åç§°** å’Œ **å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®**ï¼Œå¦‚ï¼š

```js
// index.js
#! /usr/bin/env node

console.log('hello world')
```

```json
// package.json
{
  "name": "cli-test",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "bin": {
    "cli-test": "index.js"
  },
  "author": "",
  "license": "ISC"
}
```

å¯æ‰§è¡Œæ–‡ä»¶å¤´éƒ¨çš„ `#! /usr/bin/env node` å‘Šè¯‰äº†æ–‡ä»¶ç³»ç»Ÿè¿™ä¸ªæ–‡ä»¶çš„è§£é‡Šå™¨æ˜¯ nodeã€‚

`bin` å­—æ®µæœ¬è´¨ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œçœå»äº†è·¯å¾„ï¼Œç›´æ¥é€šè¿‡å‘½ä»¤æ‰§è¡Œè„šæœ¬ã€‚

## è¯»å–å‘½ä»¤è¡Œçš„å‚æ•°

### å…¨å±€çš„ process å¯¹è±¡

`process.argv` å¯ä»¥æ‹¿åˆ°

```js
// print process.argv
process.argv.forEach((val, index) => {
  console.log(`${index}: ${val}`);
});
```

```bash
$ node process-args.js -x 3 -y 4 -n5 -abc --beep=boop foo bar baz

0: /Users/mac/.nvm/versions/node/v12.12.0/bin/node
1: /Users/mac/Desktop/GIT/node/node-practice/argv
2: -x
3: 3
4: -y
5: 4
6: -n5
7: -abc
8: --beep=boop
9: foo
10: bar
11: baz
```

è¿™æ ·è¯»å–çš„å‚æ•°ï¼Œè‡ªå·±è§£æèµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œä½¿ç”¨ [minimist](https://github.com/substack/minimist) è¿™ä¸ªä»“åº“æ¥è§£æå‚æ•°ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚

### å¿«é€Ÿå®ç°äº¤äº’å¼å‘½ä»¤è¡Œ

ä½¿ç”¨ commanderã€yargs ç­‰å·¥å…·

çœ‹è¿™ä¸ªä¾‹å­ï¼š

```js
#!/usr/bin/env node

const argv = require('yargs')
  .scriptName('cli-demo')
  .usage('$0 <cmd> [args]')
  .option('a', {
    alias: 'address',
    describe: 'è¾“å…¥åœ°å€',
    default: 'æ­å·å¸‚'
  })
  .help()
  .argv

console.log(argv)
// é€šè¿‡ argv æ‹¿åˆ°å‘½ä»¤è¡Œè¾“å…¥å‚æ•°å¯¹è±¡ï¼Œåé¢å°±å¯ä»¥å†™ JS ä»£ç ï¼Œå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œå¤„ç†
```

```sh
node argv --help

cli-demo <cmd> [args]

é€‰é¡¹ï¼š
  --help         æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯                                             [å¸ƒå°”]
  --version      æ˜¾ç¤ºç‰ˆæœ¬å·                                               [å¸ƒå°”]
  -a, --address  è¾“å…¥åœ°å€                                     [é»˜è®¤å€¼: "æ­å·å¸‚"]
```

```sh
node argv -a æµ™æ±Ÿçœ

{ _: [], a: 'æµ™æ±Ÿçœ', address: 'æµ™æ±Ÿçœ', '$0': 'cli-demo' }
```

- scriptName ç†è§£ä¸ºä¸€ä¸ªåç§°å¸¸é‡ï¼Œåœ¨åé¢çš„å‘½ä»¤å‚æ•°ä¸­å¯ä»¥ç”¨ `$0` æ¥æŒ‡ä»£ï¼Œå¦‚æœä¸è®¾ç½®çš„è¯é»˜è®¤å–æ–‡ä»¶å
- usage åªæ˜¯æ˜¾ç¤ºä¸€æ®µæ–‡å­—ï¼Œæ ‡æ³¨ä½¿ç”¨æ–¹æ³•
- help è¿™ä¸ªè°ƒç”¨æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œä¿æŒè¿™ä¸ªå†™æ³•å³å¯
- argv é€šè¿‡è®¿é—® `argv` å±æ€§ï¼Œè·å–è¾“å…¥çš„å‚æ•°

### è¡¨å•

ä½¿ç”¨ Inquirer å·¥å…·

### ç»ˆç«¯æ ·å¼

- ä½¿ç”¨ Chalk è¿™ä¸ªæ¨¡å—è¿›è¡Œå½©è‰²è¾“å‡º
- ä½¿ç”¨ sindresorhus/ora è¿™ä¸ªæ¨¡å—å¯ä»¥å±•ç¤ºå¼‚æ­¥ä»»åŠ¡çš„ Loading

## å‚è€ƒèµ„æ–™

- [ç”¨ Nodejs å¼€å‘å‘½ä»¤è¡Œå·¥å…·](https://juejin.im/post/59b73c9df265da06670c5868#npm-link%E5%91%BD%E4%BB%A4)
- [ä½¿ç”¨ Node.js å¼€å‘å‘½ä»¤è¡Œç¨‹åºçš„æœ€ä½³å®è·µ](https://juejin.im/entry/59cc906951882531086026ef)
- [ğŸ‰ç”¨Node.jså¼€å‘ä¸€ä¸ªCommand Line Interface (CLI)](https://zhuanlan.zhihu.com/p/38730825)
- [ç¿»è¯‘è®¡åˆ’-ç”¨node.jså¼€å‘ä¸€ä¸ªå¯äº¤äº’çš„å‘½ä»¤è¡Œåº”ç”¨](https://xdlrt.github.io/2017/04/15/2017-04-15/)
- [Taro æŠ€æœ¯æ­ç§˜ï¼štaro-cli](https://juejin.im/post/5b3ce041e51d45194832aaf6#heading-12)
- [npm-package.json bin](https://docs.npmjs.com/files/package.json.html#bin)
- [Node-process](https://nodejs.org/dist/latest-v12.x/docs/api/process.html#process_process_argv)
- [Github-yargs](https://github.com/yargs/yargs)
- [Github-Inquirer.js](https://github.com/SBoudrias/Inquirer.js)
- [Github-Chalk](https://github.com/chalk/chalk)
